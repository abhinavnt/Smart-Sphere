<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Product Page</title>

    <!--===============================================================================================-->	
	<link rel="icon" type="image/png" href="images/icons/favicon.png"/>
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/vendor/bootstrap/css/bootstrap.min.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.7.0/css/font-awesome.min.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="fonts/iconic/css/material-design-iconic-font.min.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="fonts/linearicons-v1.0.0/icon-font.min.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/vendor/animate/animate.css">
    <!--===============================================================================================-->	
        <link rel="stylesheet" type="text/css" href="/vendor/css-hamburgers/hamburgers.min.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/vendor/animsition/css/animsition.min.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/vendor/select2/select2.min.css">
    <!--===============================================================================================-->	
        <link rel="stylesheet" type="text/css" href="/vendor/daterangepicker/daterangepicker.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/vendor/slick/slick.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/vendor/MagnificPopup/magnific-popup.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/vendor/perfect-scrollbar/perfect-scrollbar.css">
    <!--===============================================================================================-->
        <link rel="stylesheet" type="text/css" href="/css/util.css">
        <link rel="stylesheet" type="text/css" href="/css/main.css">

    <link rel="stylesheet" href="/path/to/bootstrap.min.css">
    <link rel="stylesheet" href="/path/to/styles.css">
    

    <style>
        .pagination {
    margin: 20px 0;
    }

    .page-item.active .page-link {
        background-color: #007bff;
        border-color: #007bff;
        color: white;
    }
    .modal {
    display: none; 
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.6); 
}

.modal-content {
    background-color: #fff;
    margin: auto;
    padding: 20px;
    border-radius: 12px; 
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); 
    width: 300px;          
    height: 200px;         
    text-align: center;   
    position: relative;    
    top: 50%;             
    transform: translateY(-50%); 
}

.modal-content h2 {
    margin-top: 10px;
    font-size: 24px;
    color: #333;
}

.modal-content p {
    font-size: 18px;
    color: #555;
}

.close {
    color: #fff;
    background-color: #ff5c5c;
    border-radius: 50%;
    font-size: 18px;
    font-weight: bold;
    padding: 10px;
    width: 30px;
    height: 30px;
    line-height: 10px;
    text-align: center;
    position: absolute;
    top: -15px;
    right: -15px;
    cursor: pointer;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
}

.close:hover {
    background-color: #ff2b2b;
}

.ok-button {
    background-color: #28a745;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    font-size: 16px;
    cursor: pointer;
    margin-top: 20px;
}

.ok-button:hover {
    background-color: #218838;
}
    </style>

</head>
<body>

    	<!--Header-->
	
	<%- include('partials/_header')%>
<br>
<br>
<section class="bg0 p-t-40 p-b-10">
    <div class="container">

        <div class="flex-w flex-sb-m p-b-52">
            <div class="flex-w flex-l-m filter-tope-group m-tb-10">
                <button class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5 how-active1" data-filter="*">
                    All Products
                </button>
                <% categories.forEach(function(category) { %>
                    <button class="stext-106 cl6 hov1 bor3 trans-04 m-r-32 m-tb-5" data-filter="<%= category._id %>">
                        <%= category.categoryName %>
                    </button>
                <% }) %>
            </div>

            <div class="flex-c-m stext-106 cl6 size-105 bor4 pointer hov-btn3 trans-04 m-tb-4 js-show-search">
                <i class="icon-search cl2 m-r-6 fs-15 trans-04 zmdi zmdi-search"></i>
                <i class="icon-close-search cl2 m-r-6 fs-15 trans-04 zmdi zmdi-close dis-none"></i>
                Search
            </div>
        </div>

        <!-- Search product -->
        <div class="dis-none panel-search w-full p-t-10 p-b-15">
            <div class="bor8 dis-flex p-l-15">
                <button class="size-113 flex-c-m fs-16 cl2 hov-cl1 trans-04">
                    <i class="zmdi zmdi-search"></i>
                </button>

                <input class="mtext-107 cl2 size-114 plh2 p-r-15" type="text" name="search-product" placeholder="Search">
            </div>    
        </div>
    </div>
</section>

<!-- Toggle Filter Button -->
<div class="container">
    <div class="flex-c-m stext-106 cl6 size-105 bor4 text-white bg-dark pointer hov-btn3 trans-04 m-tb-10 js-toggle-filter">
        <i class="icon-filter cl2 m-r-6 fs-15 trans-04 zmdi zmdi-filter-list"></i>
        Filters
    </div>

    <!-- Filter -->
    <div class="dis-none panel-filter w-full p-t-10">
        <div class="wrap-filter flex-w bg-white w-full p-4 rounded shadow-lg text-center">
            <div class="filter-col1 w-100 mb-3">
                <div class="mtext-102 text-dark font-weight-bold mb-3">
                    Sort By
                </div>
                <div class="row">
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link btn text-white btn-dark  btn-block rounded-pill px-3" data-sort="default">
                            Default
                        </a>
                    </div>
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link btn text-white btn-dark btn-block rounded-pill px-3" data-sort="popularity">
                            Popularity
                        </a>
                    </div>
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link text-white btn btn-dark btn-block rounded-pill px-3" data-sort="averageRating">
                            Avg. Rating
                        </a>
                    </div>
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link text-white btn btn-dark btn-block rounded-pill px-3" data-sort="newness">
                            Newness
                        </a>
                    </div>
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link text-white btn btn-dark btn-block rounded-pill px-3" data-sort="priceLowToHigh">
                            Price: Low to High
                        </a>
                    </div>
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link btn text-white btn-dark btn-block rounded-pill px-3" data-sort="priceHighToLow">
                            Price: High to Low
                        </a>
                    </div>
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link btn text-white btn-dark btn-block rounded-pill px-3" data-sort="aToZ">
                            A - Z
                        </a>
                    </div>
                    <div class="col-md-4 mb-2">
                        <a href="#" class="filter-link btn text-white btn-dark btn-block rounded-pill px-3" data-sort="zToA">
                            Z - A
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    

    
    <!-- Ensure you have a results container -->
    <div class="row" id="product-container">
        <!-- Product cards here -->
    </div>
    

    <div class="row" id="product-container">
        <% products.forEach(function(product) { %>
            <div class="col-sm-6 col-md-4 col-lg-3 p-b-35" data-rating="<%= product.rating %>" data-category="<%= product.category %>" data-created-at="<%= product.createdAt %>">
                <div class="card h-100">
                    <a href="/product_details/<%= product._id %>">
                        <img src="<%= product.images[0] %>" class="card-img-top img-fluid product-image" alt="Product Image">
                    </a>
                    <div class="card-body">
                        <h5 class="card-title">
                            <a href="/product_details/<%= product._id %>" class="text-dark">
                                <strong><%= product.name %> <br></strong>
                                <%= product.category %>
                            </a>
                        </h5>
                        <div class="rating">
                            <% for (let i = 1; i <= 5; i++) { %>
                                <span class="star <%= i <= product.rating ? 'filled' : '' %>">&#9733;</span>
                            <% } %>
                        </div>
                        <p class="card-text">â‚¹<%= product.price %></p>
                        
                    </div>
                    <div class="card-footer d-flex justify-content-between bg-transparent border-top-0">
                        <% if (user) { %>
                            <button class="btn btn-outline-danger btn-sm">
                                <i class="bi bi-heart"></i> Wishlist
                            </button>
                            <button class="btn btn-outline-primary btn-sm add-to-cart" 
                                data-image="<%= product.images[0] %>" 
                                data-id="<%= product._id %>" 
                                data-name="<%= product.name %>" 
                                data-price="<%= product.price %>">
                                <i class="bi bi-cart"></i> Add to Cart
                            </button>
                        <% } else { %>
                            <a href="/login" class="d-flex align-items-center">
                                <button class="btn btn-outline-danger btn-sm">
                                    <i class="bi bi-heart"></i> Wishlist
                                </button> &nbsp; &nbsp;
                                <button class="btn btn-outline-primary btn-sm">
                                    <i class="bi bi-cart"></i> Add to Cart
                                </button>
                            </a>
                        <% } %>
                    </div>
                </div>
            </div>
        <% });%>
</div>
    
</div>




<!-- Out of Stock Modal -->
<div id="outOfStockModal" class="modal">
    <div class="modal-content">
        <span class="close">&times;</span>
        <h2>Oops!</h2>
        <p>This product is out of stock.</p>
        <button id="okBtn" class="ok-button">OK</button>
    </div>
</div>

<!-- Limited Stock Modal -->
<div id="limitedStockModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeLimitedStockModal">&times;</span>
        <h2>Limited Stock!</h2>
        <p id="limitedStockMessage">You are about to exceed the limit for this product.</p>
        <button class="ok-button" id="okLimitedStockBtn">OK</button>
    </div>
</div>


<!-- success Modal -->
<div id="successModal" class="modal">
    <div class="modal-content">
        <span class="close" id="closeSuccessModal">&times;</span>
        <h2>Success!</h2>
        <p id="successMessage">Product added to cart successfully!</p>
        <button id="okSuccessBtn" class="ok-button">OK</button>
    </div>
</div>




  <!-- Pagination -->
  <nav aria-label="Page navigation">
    <ul class="pagination justify-content-center">
       
        <% for (let i = 1; i <= totalPages; i++) { %>
            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                <a class="page-link" href="/shop?page=<%= i %>"><%= i %></a>
            </li>
        <% } %>
       
    </ul>
</nav>
</div>



	<!--footer-->


	<%- include('partials/_footer')%>

<!--===============================================================================================-->	
<script src="/vendor/jquery/jquery-3.2.1.min.js"></script>
<!--===============================================================================================-->
	<script src="/vendor/animsition/js/animsition.min.js"></script>
<!--===============================================================================================-->
	<script src="/vendor/bootstrap/js/popper.js"></script>
	<script src="/vendor/bootstrap/js/bootstrap.min.js"></script>
<!--===============================================================================================-->
	<script src="/vendor/select2/select2.min.js"></script>
	<script>
		$(".js-select2").each(function(){
			$(this).select2({
				minimumResultsForSearch: 20,
				dropdownParent: $(this).next('.dropDownSelect2')
			});
		})
	</script>
<!--===============================================================================================-->
	<script src="/vendor/daterangepicker/moment.min.js"></script>
	<script src="/vendor/daterangepicker/daterangepicker.js"></script>
<!--===============================================================================================-->
	<script src="/vendor/slick/slick.min.js"></script>
	<script src="js/slick-custom.js"></script>
<!--===============================================================================================-->
	<script src="/vendor/parallax100/parallax100.js"></script>
	<script>
        $('.parallax100').parallax100();
	</script>
<!--===============================================================================================-->
	<script src="/vendor/MagnificPopup/jquery.magnific-popup.min.js"></script>
	<script>
		$('.gallery-lb').each(function() { // the containers for all your galleries
			$(this).magnificPopup({
		        delegate: 'a', // the selector for gallery item
		        type: 'image',
		        gallery: {
		        	enabled:true
		        },
		        mainClass: 'mfp-fade'
		    });
		});
	</script>
<!--===============================================================================================-->
	<script src="/vendor/isotope/isotope.pkgd.min.js"></script>
<!--===============================================================================================-->
	<script src="/vendor/sweetalert/sweetalert.min.js"></script>
	<script>
		$('.js-addwish-b2').on('click', function(e){
			e.preventDefault();
		});

		$('.js-addwish-b2').each(function(){
			var nameProduct = $(this).parent().parent().find('.js-name-b2').html();
			$(this).on('click', function(){
				swal(nameProduct, "is added to wishlist !", "success");

				$(this).addClass('js-addedwish-b2');
				$(this).off('click');
			});
		});

		$('.js-addwish-detail').each(function(){
			var nameProduct = $(this).parent().parent().parent().find('.js-name-detail').html();

			$(this).on('click', function(){
				swal(nameProduct, "is added to wishlist !", "success");

				$(this).addClass('js-addedwish-detail');
				$(this).off('click');
			});
		});

		/---------------------------------------------/

		$('.js-addcart-detail').each(function(){
			var nameProduct = $(this).parent().parent().parent().parent().find('.js-name-detail').html();
			$(this).on('click', function(){
				swal(nameProduct, "is added to cart !", "success");
			});
		});
	
	</script>
<!--===============================================================================================-->
	<script src="/vendor/perfect-scrollbar/perfect-scrollbar.min.js"></script>
	<script>
		$('.js-pscroll').each(function(){
			$(this).css('position','relative');
			$(this).css('overflow','hidden');
			var ps = new PerfectScrollbar(this, {
				wheelSpeed: 1,
				scrollingThreshold: 1000,
				wheelPropagation: false,
			});

			$(window).on('resize', function(){
				ps.update();
			})
		});
	</script>


<script src="/javascripts/main.js"></script>

<script src="/path/to/jquery.min.js"></script>
<script src="/path/to/bootstrap.bundle.min.js"></script>
<script src="/path/to/scripts.js"></script>
<script>
    $(document).ready(function() {
        $('.js-toggle-filter').click(function() {
            $('.panel-filter').toggleClass('dis-none');
        });
    });
</script>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script src="/js/shop.js"></script>
<script>
   window.userId = '<%= user._id %>'; 
</script>






<script src="/javascripts/shop.js"></script>


</body>
</html>